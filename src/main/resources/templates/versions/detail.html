<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layouts/main}">
<head>
    <title th:text="${project.name + ' - Spring MCP Server'}">Project Details - Spring MCP Server</title>
</head>
<body>
<div layout:fragment="content">
    <!-- Page Header -->
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <div>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-2">
                    <li class="breadcrumb-item">
                        <a th:href="@{/versions}" class="text-decoration-none">
                            <i class="bi bi-tags"></i> Versions
                        </a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page" th:text="${project.name}">Project Name</li>
                </ol>
            </nav>
            <h1 class="h2">
                <i class="bi bi-box-seam text-spring-green"></i>
                <span th:text="${project.name}">Project Name</span>
            </h1>
        </div>
        <div class="btn-toolbar mb-2 mb-md-0">
            <a th:href="@{/versions}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Back to Versions
            </a>
        </div>
    </div>

    <div class="row">
        <!-- Project Details -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-spring-green text-white">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-info-circle"></i> Project Information
                    </h5>
                </div>
                <div class="card-body">
                    <dl class="row mb-0">
                        <dt class="col-sm-4">Project Name:</dt>
                        <dd class="col-sm-8">
                            <strong th:text="${project.name}">Spring Boot</strong>
                        </dd>

                        <dt class="col-sm-4">Slug:</dt>
                        <dd class="col-sm-8">
                            <code th:text="${project.slug}">spring-boot</code>
                        </dd>

                        <dt class="col-sm-4">Status:</dt>
                        <dd class="col-sm-8">
                            <span th:if="${project.active}"
                                  class="badge bg-success">
                                <i class="bi bi-check-circle"></i> Active
                            </span>
                            <span th:unless="${project.active}"
                                  class="badge bg-secondary">
                                <i class="bi bi-x-circle"></i> Inactive
                            </span>
                        </dd>

                        <dt class="col-sm-4">Description:</dt>
                        <dd class="col-sm-8">
                            <p th:text="${project.description ?: 'No description available'}"
                               class="mb-0">
                                Project description goes here...
                            </p>
                        </dd>

                        <dt class="col-sm-4 mt-3">Homepage:</dt>
                        <dd class="col-sm-8 mt-3">
                            <a th:if="${project.homepageUrl}"
                               th:href="${project.homepageUrl}"
                               th:text="${project.homepageUrl}"
                               target="_blank"
                               class="text-spring-green">
                                Homepage URL
                            </a>
                            <span th:unless="${project.homepageUrl}" class="text-muted">Not specified</span>
                            <i th:if="${project.homepageUrl}" class="bi bi-box-arrow-up-right ms-1"></i>
                        </dd>

                        <dt class="col-sm-4">GitHub:</dt>
                        <dd class="col-sm-8">
                            <a th:if="${project.githubUrl}"
                               th:href="${project.githubUrl}"
                               th:text="${project.githubUrl}"
                               target="_blank"
                               class="text-spring-green">
                                GitHub URL
                            </a>
                            <span th:unless="${project.githubUrl}" class="text-muted">Not specified</span>
                            <i th:if="${project.githubUrl}" class="bi bi-box-arrow-up-right ms-1"></i>
                        </dd>

                        <dt class="col-sm-4 mt-3">Created:</dt>
                        <dd class="col-sm-8 mt-3">
                            <span th:text="${#temporals.format(project.createdAt, 'yyyy-MM-dd HH:mm')}">2024-01-01 12:00</span>
                        </dd>

                        <dt class="col-sm-4">Last Updated:</dt>
                        <dd class="col-sm-8">
                            <span th:text="${#temporals.format(project.updatedAt, 'yyyy-MM-dd HH:mm')}">2024-01-01 12:00</span>
                        </dd>
                    </dl>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-spring-green text-white">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-graph-up"></i> Statistics
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-6 mb-3">
                            <div class="stat-card p-3 border rounded">
                                <div class="stat-icon text-spring-green mb-2">
                                    <i class="bi bi-tags fs-1"></i>
                                </div>
                                <h3 class="mb-0" th:text="${project.getVisibleVersions()?.size() ?: 0}">0</h3>
                                <p class="text-muted mb-0">Versions</p>
                            </div>
                        </div>
                        <div class="col-6 mb-3">
                            <div class="stat-card p-3 border rounded">
                                <div class="stat-icon text-info mb-2">
                                    <i class="bi bi-file-text fs-1"></i>
                                </div>
                                <h3 class="mb-0" th:text="${documentationCount ?: 0}">0</h3>
                                <p class="text-muted mb-0">Documentation Links</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3">
                        <h6 class="text-muted">Quick Actions</h6>
                        <div class="d-grid gap-2">
                            <a th:href="@{/documentation?projectId={id}(id=${project.id})}"
                               class="btn btn-outline-primary">
                                <i class="bi bi-file-text"></i> View Documentation
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Versions -->
    <div class="row">
        <div class="col-12 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-tags text-spring-green"></i> Project Versions
                    </h5>
                </div>
                <div class="card-body">
                    <!-- Empty State -->
                    <div th:if="${versions == null || #lists.isEmpty(versions)}" class="text-center py-4">
                        <i class="bi bi-tags display-4 text-muted"></i>
                        <p class="text-muted mt-3">
                            No versions available for this project.
                        </p>
                    </div>

                    <!-- Versions Table -->
                    <div th:if="${versions != null && !#lists.isEmpty(versions)}" class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th scope="col">Version</th>
                                    <th scope="col" class="text-center">Support</th>
                                    <th scope="col">Status</th>
                                    <th scope="col" class="text-center">Latest</th>
                                    <th scope="col">Release Date</th>
                                    <th scope="col">OSS Support End</th>
                                    <th scope="col">Enterprise Support End</th>
                                    <th scope="col">Reference Docs</th>
                                    <th scope="col">API Docs</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="ver : ${versions}">
                                    <td class="align-middle">
                                        <code th:text="${ver.version}">3.5.7</code>
                                    </td>
                                    <td class="align-middle text-center">
                                        <span th:if="${ver.getRedFlag(enterpriseSubscriptionEnabled)}">
                                            <i class="bi bi-x-circle-fill text-danger fs-5"
                                               title="Support ended"
                                               th:title="${'Support ended on ' + (enterpriseSubscriptionEnabled ?
                                                          (ver.enterpriseSupportEnd != null ? #temporals.format(ver.enterpriseSupportEnd, 'MMM dd, yyyy') : 'N/A') :
                                                          (ver.ossSupportEnd != null ? #temporals.format(ver.ossSupportEnd, 'MMM dd, yyyy') : 'N/A'))}"></i>
                                        </span>
                                        <span th:unless="${ver.getRedFlag(enterpriseSubscriptionEnabled)}">
                                            <i class="bi bi-check-circle-fill text-success fs-5"
                                               title="Supported"></i>
                                        </span>
                                    </td>
                                    <td class="align-middle">
                                        <span class="badge"
                                              th:classappend="${ver.status == 'CURRENT' ? 'bg-success' :
                                                               ver.status == 'GA' ? 'bg-primary' :
                                                               ver.status == 'RC' ? 'bg-warning text-dark' :
                                                               ver.status == 'SNAPSHOT' ? 'bg-info text-dark' :
                                                               ver.status == 'PRE' ? 'bg-secondary' :
                                                               ver.status == 'MILESTONE' ? 'bg-secondary' : 'bg-secondary'}"
                                              th:text="${ver.status ?: 'N/A'}">
                                            ${ver.status}
                                        </span>
                                    </td>
                                    <td class="align-middle text-center">
                                        <span th:if="${ver.status== 'CURRENT'}"
                                              class="text-success"
                                              title="Latest/Current Version">
                                            <i class="bi bi-check-circle-fill fs-5"></i>
                                        </span>
                                        <span th:unless="${ver.status == 'CURRENT'}"
                                              class="text-muted">
                                            <i class="bi bi-dash-circle fs-5"></i>
                                        </span>
                                    </td>
                                    <td class="align-middle">
                                        <span th:if="${ver.releaseDate}"
                                              th:text="${#temporals.format(ver.releaseDate, 'yyyy-MM-dd')}">
                                            2024-01-01
                                        </span>
                                        <span th:unless="${ver.releaseDate}" class="text-muted">-</span>
                                    </td>
                                    <td class="align-middle">
                                        <span th:if="${ver.ossSupportEnd}"
                                              th:text="${#temporals.format(ver.ossSupportEnd, 'yyyy-MM-dd')}">
                                            2025-12-31
                                        </span>
                                        <span th:unless="${ver.ossSupportEnd}" class="text-muted">-</span>
                                    </td>
                                    <td class="align-middle">
                                        <span th:if="${ver.enterpriseSupportEnd}"
                                              th:text="${#temporals.format(ver.enterpriseSupportEnd, 'yyyy-MM-dd')}">
                                            2026-12-31
                                        </span>
                                        <span th:unless="${ver.enterpriseSupportEnd}" class="text-muted">-</span>
                                    </td>
                                    <td class="align-middle">
                                        <a th:if="${ver.referenceDocUrl}"
                                           th:href="${ver.referenceDocUrl}"
                                           target="_blank"
                                           class="btn btn-sm btn-outline-primary"
                                           title="Reference Documentation">
                                            <i class="bi bi-book"></i>
                                        </a>
                                        <span th:unless="${ver.referenceDocUrl}" class="text-muted">-</span>
                                    </td>
                                    <td class="align-middle">
                                        <a th:if="${ver.apiDocUrl}"
                                           th:href="${ver.apiDocUrl}"
                                           target="_blank"
                                           class="btn btn-sm btn-outline-primary"
                                           title="API Documentation">
                                            <i class="bi bi-file-code"></i>
                                        </a>
                                        <span th:unless="${ver.apiDocUrl}" class="text-muted">-</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Documentation Links -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-file-text text-spring-green"></i> Documentation Links
                    </h5>
                </div>
                <div class="card-body">
                    <!-- Empty State -->
                    <div th:if="${#lists.isEmpty(documentationLinks)}" class="text-center py-4">
                        <i class="bi bi-file-text display-4 text-muted"></i>
                        <p class="text-muted mt-3">No documentation links available for this project.</p>
                    </div>

                    <!-- Documentation List -->
                    <div th:if="${!#lists.isEmpty(documentationLinks)}" class="row">
                        <div class="col-md-6 mb-3" th:each="doc : ${documentationLinks}">
                            <div class="card h-100 border-start border-spring-green border-3">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <a th:href="${doc.url}"
                                           th:text="${doc.title}"
                                           target="_blank"
                                           class="text-decoration-none text-spring-green">
                                            Documentation Title
                                        </a>
                                        <i class="bi bi-box-arrow-up-right small"></i>
                                    </h6>
                                    <p class="card-text small text-muted mb-2" th:if="${doc.description}">
                                        <span th:text="${#strings.abbreviate(doc.description, 100)}">Description...</span>
                                    </p>
                                    <div>
                                        <small class="text-muted">
                                            <span th:if="${doc.docType}"
                                                  th:text="${doc.docType.name}"
                                                  class="badge bg-secondary">
                                                Type
                                            </span>
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Custom Styles -->
<th:block layout:fragment="scripts">
    <style>
        .bg-spring-green {
            background-color: #6db33f;
        }

        .text-spring-green {
            color: #6db33f;
        }

        .btn-spring-green {
            background-color: #6db33f;
            border-color: #6db33f;
            color: white;
        }

        .btn-spring-green:hover {
            background-color: #5a9a35;
            border-color: #5a9a35;
            color: white;
        }

        .btn-outline-spring-green {
            border-color: #6db33f;
            color: #6db33f;
        }

        .btn-outline-spring-green:hover {
            background-color: #6db33f;
            border-color: #6db33f;
            color: white;
        }

        .border-spring-green {
            border-color: #6db33f !important;
        }

        .stat-card {
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .table-hover tbody tr:hover {
            background-color: rgba(109, 179, 63, 0.05);
        }

        .breadcrumb-item + .breadcrumb-item::before {
            color: #6c757d;
        }

        .breadcrumb-item.active {
            color: #6db33f;
        }
    </style>
</th:block>
</body>
</html>
